# AGENTS.md

## 🧠 Agent Name

`sanrio-personality-checker`

---

## 🪞Purpose

30代女性をターゲットにした、**恋愛傾向ベースの性格診断Webアプリ**。  
全16問の選択式設問に答えると、「あなたの性格タイプ」が4軸の傾向から導き出され、**16パターンのサンリオキャラ**とともに結果が表示されます。  
恋愛観・働き方・推し活など、日常に役立つインサイトを「かわいい診断体験」として届けます。

---

## ⚙️ Capabilities

- 2択×4軸による性格診断（全16タイプ）
- 選択式設問（全16問、固定順）
- 診断ロジックはクライアントサイドで完結
- 結果はキャラクター画像＋解説テキストで出力
- SNSシェアボタンあり（X/Twitter 等）
- 診断履歴の保存なし
- 「もう一度診断する」ボタンで再挑戦可能

---

## 🔢 Personality Axes

| 軸カテゴリ       | Aタイプ（+1）             | Bタイプ             |
|------------------|----------------------------|---------------------|
| 行動原理         | Social（もてたい）         | Intrinsic（おもしろい） |
| 認知スタイル     | Concrete（具体思考）        | Abstract（抽象思考）   |
| 行動スタンス     | Structured（きっちり派）     | Flow（流れに乗る派）    |
| エネルギー補充   | Talk（人と話すと元気）       | Quiet（一人の時間で元気） |

---

## 🧮 Scoring Logic

- 各設問は4軸のいずれかに紐づき、A/Bで1点ずつ加算
- 軸ごとにスコアが 2 以上なら A タイプ、未満なら B タイプ
- 組み合わせにより 2^4 = 16 パターンを生成（例：SCF-T）
- それぞれに対応するサンリオキャラクターとテンプレート結果が表示される

---

## 📝 Input Schema

```json
{
  "answers": [
    "A", "B", "A", ..., "B"  // 全16問、各選択肢は "A" または "B"
  ]
}
```


### レビューと品質保証の追加ポイント
- 主要コンポーネントや API の変更時は Storybook などの UI カタログを更新し、差分確認用のスクリーンショットを添付します。
- 新しい依存ライブラリを追加する場合は、ライセンスとバンドルサイズへの影響を確認し、PR 説明欄に記録します。
- 既存機能への回帰を避けるため、Playwright のスモークケースを最小 1 件でも追加／更新し、手動確認が必要な場合は手順を`docs/qa-checklist.md`へ追記してください。
- 本番環境向けの設定変更があれば `docs/release-notes/` にデプロイ手順とロールバック方法を残し、影響範囲をチームへ共有します。

### ローカル開発環境のセットアップ補足
1. Node.js は LTS バージョンを使用し、`nvm use` でプロジェクトルートの `.nvmrc` を読み込みます。
2. `npm install` 後に `npm run prepare` を実行して Husky フックを有効化します。プリコミットで `lint` と `format` が自動実行されます。
3. Next.js の開発サーバと API モックを並列起動したい場合は `npm run dev:api` を別ターミナルで起動し、`.env.local` に `API_BASE_URL=http://localhost:4000` を設定してください。
4. Playwright のブラウザ依存ファイルが無い場合は `npx playwright install` を一度だけ実行します。

### デプロイと運用メモ
- ステージング環境は `main` ブランチから自動デプロイされます。手動デプロイ時は `npm run build && npm run start` が落ちないこと、Playwright スモークケースが成功することを CI ログで確認してください。
- 本番向けリリースでは `npm run build` の成果物をアーティファクト化し、Infra チームが用意したデプロイスクリプトに渡します。環境変数はクラウド側で注入されるため、`.env.production` はローカルのみに留めます。
- 障害対応時は `logs/` 以下のローテートログを参照しつつ、`docs/incident-response.md` に沿ってタイムラインを記録します。再発防止アクションは PR 化し、ガイドラインにも反映してください。
